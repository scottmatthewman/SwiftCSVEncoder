{"metadata":{"role":"article","title":"Exporting CSV from SwiftUI","modules":[{"name":"SwiftCSVEncoder"}],"roleHeading":"Article"},"kind":"article","schemaVersion":{"major":0,"patch":0,"minor":3},"primaryContentSections":[{"kind":"content","content":[{"level":2,"anchor":"Overview","type":"heading","text":"Overview"},{"type":"paragraph","inlineContent":[{"type":"reference","identifier":"doc:\/\/SwiftCSVEncoder\/documentation\/SwiftCSVEncoder","isActive":true},{"type":"text","text":" only includes code to generate a CSV file as a string. If you include the library"},{"type":"text","text":" "},{"text":"into your application, it’s up to you how you incorporate the exporting of documents into your app.","type":"text"}]},{"type":"paragraph","inlineContent":[{"type":"text","text":"SwiftUI includes several useful components that make the exporting process relatively straightforward."},{"text":" ","type":"text"},{"type":"text","text":"The following is an example of one approach."}]},{"content":[{"type":"paragraph","inlineContent":[{"type":"text","text":"This walkthrough includes technologies first introduced in iOS 16.0 and 17.0, and the equivalent OS versions on Apple’s other platforms."}]}],"style":"tip","type":"aside","name":"Tip"},{"level":2,"type":"heading","anchor":"Walkthrough","text":"Walkthrough"},{"level":3,"type":"heading","anchor":"1-Create-an-object-that-represents-your-exported-data","text":"1. Create an object that represents your exported data"},{"inlineContent":[{"type":"text","text":"To represent your data file that will be exported, you need an object that can represent just the data"},{"type":"text","text":" "},{"type":"text","text":"you’re exporting. It’s possible that you already have such an object, but it may also make sense to cerate"},{"type":"text","text":" "},{"text":"a separate object and pass in the data to be exported.","type":"text"}],"type":"paragraph"},{"type":"codeListing","syntax":"swift","code":["struct CSVFile {","  var events: [Event]","","  init(events: [Event]) {","    self.events = events","  }","}"]},{"anchor":"2-Add-a-method-to-generate-the-CSV-data","level":3,"text":"2. Add a method to generate the CSV data","type":"heading"},{"code":["import SwiftCSVEncoder","","extension CSVFile {","  func csvData() -> String {","    let table = CSVTable<Event>(","      columns: [","        CSVColumn(\"Title\", \\.title),","        CSVColumn(\"Date\", \\.date),","        CSVColumn(\"Venue Name\", \\.venueName),","        CSVColumn(\"City\", \\.city)","      ], ","      configuration: CSVEncoderConfiguration(dateDecodingStrategy: .iso8601) ","    )","","    return table.export(rows: events)","  }","}"],"type":"codeListing","syntax":"swift"},{"type":"heading","anchor":"3-Make-the-object-conform-to-Transferable","text":"3. Make the object conform to `Transferable`","level":3},{"type":"paragraph","inlineContent":[{"type":"text","text":"The "},{"type":"reference","identifier":"https:\/\/developer.apple.com\/documentation\/coretransferable\/transferable#","isActive":true},{"type":"text","text":" protocol"},{"text":" ","type":"text"},{"type":"text","text":"simplifies how to manage interaction of your app’s data with operating system APIs, including file export."}]},{"type":"paragraph","inlineContent":[{"text":"To make your CSV file exportable, import the ","type":"text"},{"type":"codeVoice","code":"CoreTransferable"},{"type":"text","text":" library and add conformance."}]},{"type":"codeListing","code":["import CoreTransferable","","extension CSVFile: Transferable {","  static var transferRepresentation: some TransferRepresentation {","    DataRepresentation(exportedContentType: .commaSeparatedText) { file in","      Data(file.csvData().utf8)","    }","  }","}"],"syntax":"swift"},{"text":"4. Add an export button to your app","level":3,"anchor":"4-Add-an-export-button-to-your-app","type":"heading"},{"type":"paragraph","inlineContent":[{"type":"text","text":"SwiftUI offers a "},{"type":"codeVoice","code":"fileExporter"},{"type":"text","text":" modifier which you attach to a parent view in the same way you would to"},{"text":" ","type":"text"},{"text":"a sheet, full screen cover, etc.","type":"text"}]},{"type":"paragraph","inlineContent":[{"type":"text","text":"It requires two "},{"code":"@State","type":"codeVoice"},{"type":"text","text":" variables: a "},{"type":"codeVoice","code":"Boolean"},{"text":" to cover whether or not to show the export dialog, and an","type":"text"},{"type":"text","text":" "},{"type":"text","text":"instance of our "},{"type":"codeVoice","code":"CSVFile"},{"text":". In this example, we only need our file while the export process is going on","type":"text"},{"type":"text","text":" "},{"type":"text","text":"(because it contains a copy of the data generated just for the purpose) so we can create it just before"},{"text":" ","type":"text"},{"type":"text","text":"it’s needed."}]},{"type":"paragraph","inlineContent":[{"text":"We add an ","type":"text"},{"inlineContent":[{"text":"Export","type":"text"}],"type":"strong"},{"text":" button that sets these two values, and add the ","type":"text"},{"type":"codeVoice","code":"fileExporter"},{"text":" modifier to make use of","type":"text"},{"text":" ","type":"text"},{"type":"text","text":"them."}]},{"syntax":"swift","code":["import SwiftUI","","struct ContentView {","  \/\/ assume this is the source for our app's data","  @EnvironmentObject var dataModel: DataModel","","  @State private var showingExporter = false","  @State private var csvFile: CSVFile?","","  var body: some Body {","    List(dataModel.events) { event in","      \/\/ display the list of events ","    }","    .toolbar {","      Button(\"Export\") {","        csvFile = CSVFile(events: dataModel.events)","        showingExporter = true","      }","    }","    .fileExporter(","      isPresented: $showingExporter,","      item: csvFile,","      contentTypes: [.commaSeparatedText]","    )","  }","}"],"type":"codeListing"},{"content":[{"type":"paragraph","inlineContent":[{"text":"When the export operation completes or the user cancels, ","type":"text"},{"type":"codeVoice","code":"showingExporter"},{"text":" will revert to ","type":"text"},{"code":"false","type":"codeVoice"},{"type":"text","text":""},{"type":"text","text":" "},{"type":"text","text":"but "},{"type":"codeVoice","code":"csvFile"},{"text":" will not be removed, so the ","type":"text"},{"type":"codeVoice","code":"CSVFile"},{"type":"text","text":" object will still be in memory. In many circumstances"},{"type":"text","text":" "},{"text":"this may be okay. You may optionally choose to implement the ","type":"text"},{"code":"fileExporter","type":"codeVoice"},{"type":"text","text":" modifier’s "},{"code":"onCompletion","type":"codeVoice"},{"text":" and","type":"text"},{"type":"text","text":" "},{"code":"onCancellation","type":"codeVoice"},{"type":"text","text":" methods, and set "},{"type":"codeVoice","code":"csvFile = nil"},{"type":"text","text":" to deallocate the file."}]}],"type":"aside","name":"Note","style":"note"}]}],"hierarchy":{"paths":[["doc:\/\/SwiftCSVEncoder\/documentation\/SwiftCSVEncoder"]]},"variants":[{"paths":["\/documentation\/swiftcsvencoder\/incorporatingcsv"],"traits":[{"interfaceLanguage":"swift"}]}],"sections":[],"identifier":{"interfaceLanguage":"swift","url":"doc:\/\/SwiftCSVEncoder\/documentation\/SwiftCSVEncoder\/IncorporatingCSV"},"abstract":[{"text":"Generating CSV data is one thing. How you build the export into your app is another matter.","type":"text"}],"references":{"https://developer.apple.com/documentation/coretransferable/transferable#":{"identifier":"https:\/\/developer.apple.com\/documentation\/coretransferable\/transferable#","type":"link","titleInlineContent":[{"type":"codeVoice","code":"Transferable"}],"title":"Transferable","url":"https:\/\/developer.apple.com\/documentation\/coretransferable\/transferable#"},"doc://SwiftCSVEncoder/documentation/SwiftCSVEncoder":{"url":"\/documentation\/swiftcsvencoder","kind":"symbol","type":"topic","abstract":[{"type":"text","text":"A lightweight library for generating CSV files from your Swift data."}],"title":"SwiftCSVEncoder","identifier":"doc:\/\/SwiftCSVEncoder\/documentation\/SwiftCSVEncoder","role":"collection"}}}